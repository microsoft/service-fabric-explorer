<div class="command-safety" [ngSwitch]="command.safetyLevel">
    <ngb-alert *ngSwitchCase="safetyLevelEnum.safe" type="success" [dismissible]="false">
        <app-health-badge text="This command is safe" [badgeClass]="BadgeConstants.BadgeOK"></app-health-badge>
    </ngb-alert>
    <ngb-alert *ngSwitchCase="safetyLevelEnum.unsafe" type="warning" [dismissible]="false">
        <app-health-badge text="This command is unsafe" [badgeClass]="BadgeConstants.BadgeWarning"></app-health-badge>
    </ngb-alert>
    <ngb-alert *ngSwitchCase="safetyLevelEnum.dangerous" type="danger" [dismissible]="false">
        <app-health-badge text="This command is dangerous" [badgeClass]="BadgeConstants.BadgeError"></app-health-badge>
    </ngb-alert>
</div>

<div class="detail-pane essen-pane">

    <div class="command-name">
        <h5>{{command.name}}</h5>
        <a target="_blank" [href]="command.referenceUrl" *ngIf="command.referenceUrl" [attr.aria-label]="'learn about' + command.name">
            <span class="mif-info link"></span>
        </a>
    </div>
    <form #inputForm="ngForm" class="input-group">
        <div *ngFor="let commandParam of command.parameters" class="user-input">
            <label *ngIf="commandParam.type !== paramTypes.bool" [for]="commandParam.name">{{commandParam.name}}</label>
            <div [ngSwitch]="commandParam.type">
                
                <input *ngSwitchCase="paramTypes.string" [id]="commandParam.name" [name]="commandParam.name"
                type="text" [(ngModel)]="commandParam.value" [required]="commandParam.required" class="input-flat" />
                
                <input *ngSwitchCase="paramTypes.number" [id]="commandParam.name" [name]="commandParam.name"
                type="number" [(ngModel)]="commandParam.value" [required]="commandParam.required" class="input-flat"/>
    
                <div *ngSwitchCase="paramTypes.enum" ngbDropdown 
                [class]="(dropDownInput.invalid ? 'invalid ' : 'valid ') + (commandParam.required ? 'required' : '')" >
                    
                    <input [id]="commandParam.name" [name]="commandParam.name" #dropDownInput="ngModel"
                    type="hidden" [(ngModel)]="commandParam.value" [required]="commandParam.required" />
                    
                    <button class="simple-button" ngbDropdownToggle>{{commandParam.value ? commandParam.value : '-Select-'}}</button>
                    
                    <div ngbDropdownMenu>
                        <div *ngFor="let option of commandParam.options" >
                            <button [value]="option"  
                            ngbDropdownItem (click)="setDropdownValue($event, commandParam)">
                                {{option}}
                            </button>
                        </div>
                    </div>
                </div>
                
                <!-- no need to account for required fields, as required bools are in the prefix -->
                <div *ngSwitchCase="paramTypes.bool">
                    <label>
                        {{commandParam.name}}
                        <app-toggle [(state)]="commandParam.value"></app-toggle>
                    </label>
                </div>
            
            </div>     
        </div>
    </form>

    <div class="card"c>
        <div class="card-body">
            
            <span *ngIf="inputForm.valid; else disabledCopy">
                <app-clip-board style="float: right;" [text]="command.getScript()"></app-clip-board>
            </span>
            <ng-template #disabledCopy>
                <div class="mif-copy disabled-copy" ngbTooltip="missing required properties!" tooltipClass="styled-tooltip"></div>
            </ng-template>
            <p class="card-text">
                {{command.prefix}}
                <span *ngFor="let param of (command | json | formatParams)"> {{param.name}} <span class="param-value"> {{param.value}} </span></span>
            </p>
        </div>
    </div>
</div>