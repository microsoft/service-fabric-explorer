<div class="essen-pane detail-pane">
  <div style="margin-bottom: 10px;" *ngIf="dateMin">
    <app-time-picker [dateMin]="dateMin" (dateChange)="setDate($event)"></app-time-picker>
  </div>
  <div class="event-title">
    <h5>Events: </h5>
    <b>
      This preset of entity types and event filters can be edited, added to, or removed.
    </b>
      <a href="https://learn.microsoft.com/azure/service-fabric/service-fabric-diagnostics-event-generation-operational" target="_blank" title="reference for list of events">
        <i class="mif-info link" ></i>
        Learn more.
      </a>
  </div>
  <div id="chips" data-cy="event-chips">
    <span *ngFor="let chip of listEventChips">
      <app-event-chip [chip]="chip" (loadEvent)="addEvents($event)" (removeEvent)="removeEvents($event)"></app-event-chip>
    </span>
    <app-event-chip [addChip]="true" (loadEvent)="addEvents($event)" data-cy="add-event"></app-event-chip>
  </div>
</div>

<div *ngFor="let ref of vizRefs">
  <app-collapse-container class="essen-pane detail-pane">
    <h5 collapse-header>
      {{ref.name}}
    </h5>
    <div collapse-body>
      <ng-template appVisualization></ng-template>
    </div>
  </app-collapse-container>
</div>

<div class="essen-pane">
  <div style="height: 20px;">
    <a class="link" style="float: right;"> Why is data missing?
      <span class="mif-info"
        title="This timeline may present incomplete information and not fully represent the cluster for this date range. Events may also be missing due to data loss and lead to incomplete states. E.g.: A cluster upgrade starting before or ending after this time range will not be shown."></span>
    </a>
  </div>

  <app-health-badge *ngIf="failedRefresh" text=" Some items failed to load." badgeClass="badge-warning">
  </app-health-badge>

  <div ngbNav #nav="ngbNav" data-cy="eventtabs" class="nav-wrapper" [(activeId)]="activeTab">
    <div ngbNavItem *ngFor="let data of listEventStoreData; let i = index" [ngbNavItem]="i">
      <a ngbNavLink class="bar-name">
        <div *ngIf="data.eventsList.isRefreshing" class="mif-refresh rotate link"
              ngbTooltip="This data is currently loading."  tooltipClass="styled-tooltip"></div>
        <app-health-badge *ngIf="!data.eventsList.lastRefreshWasSuccessful" text="Error" [showText]="false"
          badgeClass="badge-error"></app-health-badge>
        {{data.displayName}}
        ({{data.eventsList.collection.length}})
        <i *ngIf="listEventChips[i].eventsFilter.length" class="mif-filter" [ngbTooltip]="'Applied Filters: ' + (listEventChips[i].eventsFilter.length ? listEventChips[i].eventsFilter : 'None')"
        placement="bottom" tooltipClass="styled-tooltip"></i> 
      </a>
      <ng-template ngbNavContent>
        
        <app-detail-list [list]="data.eventsList.collection" [listSettings]="data.listSettings"
          [isLoading]="!data.eventsList.isInitialized" [successfulLoad]="data.eventsList.lastRefreshWasSuccessful">
          <div *ngIf="listEventChips[i].eventsFilter.length" class="card">
            <div class="card-body">
              <span class="card-text" data-cy="filter-card">
                Applied Filter: <b>{{listEventChips[i].eventsFilter}}</b>
              </span>
            </div>
          </div>
        </app-detail-list>
      </ng-template>
    </div>
  </div>
  <div [ngbNavOutlet]="nav"></div>
  <div>
    <div style="float: right; padding: 15px 0 0 0; margin: 0px;">
      <span class="dropdown-toggle dark-background-link bowtie-icon bowtie-status-error limit-wrapper"></span>
      <div style="display: inline-block;">
        There is a limit of up to 500 events for a given range.
      </div>
    </div>
  </div>
</div>  
